import{_ as B}from"./CpPaySheet-93ad77aa.js";import{_ as D}from"./CpNavBar-ea159524.js";import{d as M}from"./vue-router-fd42b9e3.js";import{O as N}from"./OrderMedical-4b91792b.js";import{a as R,b as T,c as U}from"./order-59513380.js";import{O as A,u as n,Z as j,o as h,R as g,Q as e,S as l,T as p,U as b,W as q,X as E,Y as F,_ as G}from"./_plugin-vue_export-helper-4a308993.js";import{I as L}from"./index-f7b1a7d1.js";import{C as Q}from"./index-93886e3d.js";import{C as W}from"./index-7ca2e351.js";import{C as X}from"./index-009019c7.js";import{S as Y}from"./index-dd751e82.js";import{S as Z}from"./index-4fee20b9.js";import{s as y}from"./request-4f3541ce.js";import"./CpIcon-56491ba7.js";import"./consult-7375c68e.js";import"./index-a2a726fb.js";import"./use-route-27c093b5.js";import"./use-placeholder-ca8c31e0.js";import"./index-5f55da43.js";import"./interceptor-4f4458bc.js";const x=i=>(E("data-v-ab422db5"),i=i(),F(),i),z={key:0,class:"order-pay-page"},H={class:"order-address"},J={class:"area"},K={class:"detail"},ee={class:"order-detail"},ae={class:"order-tip"},te=x(()=>l("p",{class:"tip"}," 由于药品的特殊性，如非错发、漏发药品的情况，药品一经发出 不得退换，请核对药品信息无误后下单。 ",-1)),oe=x(()=>l("a",{href:"javascript:;"},"支付协议",-1)),se={key:1,class:".order-pay-page"},le=A({__name:"OrderPay",setup(i){const w=M(),a=n(),I=async()=>{const s=await R({prescriptionId:w.query.id});a.value=s.data},t=n(),P=async()=>{const s=await T();if(s.data.length){const o=s.data.find(r=>r.isDefault===1);o?t.value=o:t.value=s.data[0]}};j(async()=>{I(),P()});const _=n(""),d=n(!1),c=n(!1),m=n(!1),k=async()=>{var s,o;if(!m.value)return y("请同意支付协议");if(!((s=t.value)!=null&&s.id))return y("请选择收货地址");if(!((o=a.value)!=null&&o.id))return y("未找到处方");if(_.value)c.value=!0;else{d.value=!0;try{const r=await U({id:a.value.id,addressId:t.value.id,couponId:a.value.couponId});_.value=r.data.id,d.value=!1,c.value=!0}catch{d.value=!1}}};return(s,o)=>{const r=D,C=L,u=Q,O=W,S=X,$=Y,V=B,v=Z;return a.value&&t.value?(h(),g("div",z,[e(r,{title:"药品支付"}),l("div",H,[l("p",J,[e(C,{name:"location"}),l("span",null,p(t.value.province+t.value.city+t.value.county),1)]),l("p",K,p(t.value.addressDetail),1),l("p",null,p(t.value.receiver)+" "+p(t.value.mobile.replace(/^(\d{3})\d+(\d{4})$/,"$1****$2")),1)]),e(N,{medicines:a.value.medicines},null,8,["medicines"]),l("div",ee,[e(O,null,{default:b(()=>[e(u,{title:"药品金额",value:`¥ ${a.value.payment}`},null,8,["value"]),e(u,{title:"运费",value:`¥ ${a.value.expressFee}`},null,8,["value"]),e(u,{title:"优惠券",value:`- ¥ ${a.value.couponDeduction}`},null,8,["value"]),e(u,{title:"实付款",value:`¥ ${a.value.actualPayment}`,class:"price"},null,8,["value"])]),_:1})]),l("div",ae,[te,e(S,{modelValue:m.value,"onUpdate:modelValue":o[0]||(o[0]=f=>m.value=f)},{default:b(()=>[q("我已同意"),oe]),_:1},8,["modelValue"])]),e($,{price:a.value.actualPayment*100,"button-text":"立即支付","button-type":"primary","text-align":"left",loading:d.value,onClick:k},null,8,["price","loading"]),e(V,{show:c.value,"onUpdate:show":o[1]||(o[1]=f=>c.value=f),orderId:_.value,actualPayment:a.value.actualPayment,payCallback:"/order/pay/result"},null,8,["show","orderId","actualPayment"])])):(h(),g("div",se,[e(r,{title:"药品支付"}),e(v,{title:"",avatar:"",row:"2",style:{"margin-top":"15px"}}),e(v,{title:"",row:"4",style:{"margin-top":"50px"}}),e(v,{title:"",row:"4",style:{"margin-top":"50px"}})]))}}});const Ce=G(le,[["__scopeId","data-v-ab422db5"]]);export{Ce as default};
