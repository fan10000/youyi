import{p as F,e as H,P as R,m as K,d as p}from"./request-4f3541ce.js";import{w as I}from"./index-5f55da43.js";import{B as v}from"./index-a2a726fb.js";import{A as k,a as U}from"./index-470ccc52.js";import{c as z,f as m,n as L,h as M,m as W,t as P,A as Q,k as V,X as T,d as X,a4 as j,a5 as q,M as G}from"./index-f7b1a7d1.js";import{O as J,u as Y,z as Z,Q as o,a2 as S}from"./_plugin-vue_export-helper-4a308993.js";import{c as $}from"./interceptor-4f4458bc.js";const[ee,l,f]=z("dialog"),te=m({},F,{title:String,theme:String,width:L,message:[String,Function],callback:Function,allowHtml:Boolean,className:M,transition:W("van-dialog-bounce"),messageAlign:String,closeOnPopstate:P,showCancelButton:Boolean,cancelButtonText:String,cancelButtonColor:String,cancelButtonDisabled:Boolean,confirmButtonText:String,confirmButtonColor:String,confirmButtonDisabled:Boolean,showConfirmButton:P,closeOnClickOverlay:Boolean}),ne=[...H,"transition","closeOnPopstate"];var oe=J({name:ee,props:te,emits:["confirm","cancel","keydown","update:show"],setup(e,{emit:r,slots:a}){const u=Y(),i=Z({confirm:!1,cancel:!1}),C=t=>r("update:show",t),b=t=>{var n;C(!1),(n=e.callback)==null||n.call(e,t)},y=t=>()=>{e.show&&(r(t),e.beforeClose?(i[t]=!0,$(e.beforeClose,{args:[t],done(){b(t),i[t]=!1},canceled(){i[t]=!1}})):b(t))},B=y("cancel"),g=y("confirm"),x=I(t=>{var n,s;if(t.target!==((s=(n=u.value)==null?void 0:n.popupRef)==null?void 0:s.value))return;({Enter:e.showConfirmButton?g:T,Escape:e.showCancelButton?B:T})[t.key](),r("keydown",t)},["enter","esc"]),O=()=>{const t=a.title?a.title():e.title;if(t)return o("div",{class:l("header",{isolated:!e.message&&!a.default})},[t])},D=t=>{const{message:n,allowHtml:s,messageAlign:c}=e,d=l("message",{"has-title":t,[c]:c}),w=X(n)?n():n;return s&&typeof w=="string"?o("div",{class:d,innerHTML:w},null):o("div",{class:d},[w])},A=()=>{if(a.default)return o("div",{class:l("content")},[a.default()]);const{title:t,message:n,allowHtml:s}=e;if(n){const c=!!(t||a.title);return o("div",{key:s?1:0,class:l("content",{isolated:!c})},[D(c)])}},E=()=>o("div",{class:[q,l("footer")]},[e.showCancelButton&&o(v,{size:"large",text:e.cancelButtonText||f("cancel"),class:l("cancel"),style:{color:e.cancelButtonColor},loading:i.cancel,disabled:e.cancelButtonDisabled,onClick:B},null),e.showConfirmButton&&o(v,{size:"large",text:e.confirmButtonText||f("confirm"),class:[l("confirm"),{[j]:e.showCancelButton}],style:{color:e.confirmButtonColor},loading:i.confirm,disabled:e.confirmButtonDisabled,onClick:g},null)]),N=()=>o(U,{class:l("footer")},{default:()=>[e.showCancelButton&&o(k,{type:"warning",text:e.cancelButtonText||f("cancel"),class:l("cancel"),color:e.cancelButtonColor,loading:i.cancel,disabled:e.cancelButtonDisabled,onClick:B},null),e.showConfirmButton&&o(k,{type:"danger",text:e.confirmButtonText||f("confirm"),class:l("confirm"),color:e.confirmButtonColor,loading:i.confirm,disabled:e.confirmButtonDisabled,onClick:g},null)]}),_=()=>a.footer?a.footer():e.theme==="round-button"?N():E();return()=>{const{width:t,title:n,theme:s,message:c,className:d}=e;return o(R,S({ref:u,role:"dialog",class:[l([s]),d],style:{width:V(t)},tabindex:0,"aria-labelledby":n||c,onKeydown:x,"onUpdate:show":C},Q(e,ne)),{default:()=>[O(),A(),_()]})}}});let h;const ae={title:"",width:"",theme:null,message:"",overlay:!0,callback:null,teleport:"body",className:"",allowHtml:!1,lockScroll:!0,transition:void 0,beforeClose:null,overlayClass:"",overlayStyle:void 0,messageAlign:"",cancelButtonText:"",cancelButtonColor:null,cancelButtonDisabled:!1,confirmButtonText:"",confirmButtonColor:null,confirmButtonDisabled:!1,showConfirmButton:!0,showCancelButton:!1,closeOnPopstate:!0,closeOnClickOverlay:!1};let le=m({},ae);function se(){({instance:h}=K({setup(){const{state:r,toggle:a}=p();return()=>o(oe,S(r,{"onUpdate:show":a}),null)}}))}function ce(e){return G?new Promise((r,a)=>{h||se(),h.open(m({},le,e,{callback:u=>{(u==="confirm"?r:a)(u)}}))}):Promise.resolve()}const ge=e=>ce(m({showCancelButton:!0},e));export{oe as a,ce as b,ge as s};
